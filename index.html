<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>User Dashboard üíº</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" rel="stylesheet">
<style>
  body {
    background: linear-gradient(135deg, #667eea, #764ba2);
    font-family: 'Poppins', sans-serif;
    padding: 40px;
  }
  .dashboard {
    max-width: 1200px;
    margin: auto;
  }
  .dashboard-header {
    text-align: center;
    color: white;
    margin-bottom: 30px;
  }
  .dashboard-header h2 {
    font-weight: 600;
  }
  .user-form {
    background: rgba(255,255,255,0.2);
    border-radius: 20px;
    padding: 20px;
    backdrop-filter: blur(10px);
    color: white;
  }
  .user-card {
    background: rgba(255,255,255,0.15);
    border-radius: 20px;
    text-align: center;
    padding: 20px;
    color: #fff;
    backdrop-filter: blur(12px);
    box-shadow: 0 5px 15px rgba(0,0,0,0.2);
    transition: all 0.3s;
    position: relative;
  }
  .user-card:hover {
    transform: translateY(-6px);
  }
  .avatar {
    width: 90px;
    height: 90px;
    border-radius: 50%;
    object-fit: cover;
    border: 3px solid white;
    margin-bottom: 10px;
  }
  .favorite {
    position: absolute;
    top: 10px;
    right: 15px;
    font-size: 1.5rem;
    cursor: pointer;
  }
  .favorite:hover {
    transform: scale(1.2);
  }
  .search-bar {
    border-radius: 25px;
    padding: 8px 20px;
    border: none;
    width: 300px;
  }
  .btn-custom {
    border-radius: 25px;
    font-weight: 500;
  }
  .animate__fadeInUp {
    animation-duration: 0.7s;
  }
</style>
</head>
<body>

<div class="dashboard">
  <div class="dashboard-header animate__animated animate__fadeInDown">
    <h2>üë• User Dashboard</h2>
    <p class="text-light">Manage user profiles with style ‚ú®</p>
  </div>

  <!-- Search and Add Section -->
  <div class="d-flex justify-content-between align-items-center mb-4">
    <input type="text" id="search" class="search-bar" placeholder="üîç Search users...">
    <button class="btn btn-light btn-custom" data-bs-toggle="collapse" data-bs-target="#formSection">‚ûï Add / Edit</button>
  </div>

  <!-- Add/Edit Form -->
  <div class="collapse mb-4" id="formSection">
    <form id="userForm" class="row g-2 user-form">
      <div class="col-md-4">
        <input type="text" id="name" class="form-control" placeholder="üë§ Name" required>
      </div>
      <div class="col-md-4">
        <input type="email" id="email" class="form-control" placeholder="üìß Email" required>
      </div>
      <div class="col-md-3">
        <input type="file" id="avatar" accept="image/*" class="form-control">
      </div>
      <div class="col-md-1">
        <button type="submit" class="btn btn-success w-100 btn-custom">üíæ</button>
      </div>
    </form>
  </div>

  <!-- User Grid -->
  <div class="row" id="userGrid"></div>
</div>

<script>
  let users = [];
  let editIndex = -1;

  const userForm = document.getElementById('userForm');
  const userGrid = document.getElementById('userGrid');
  const search = document.getElementById('search');

  userForm.addEventListener('submit', (e) => {
    e.preventDefault();
    const name = document.getElementById('name').value.trim();
    const email = document.getElementById('email').value.trim();
    const avatarFile = document.getElementById('avatar').files[0];

    const duplicate = users.some((u, i) => i !== editIndex && (u.name === name || u.email === email));
    if (duplicate) {
      alert('‚ö†Ô∏è Duplicate Name or Email not allowed!');
      return;
    }

    const reader = new FileReader();
    reader.onload = (event) => {
      const avatar = avatarFile ? event.target.result : 'https://via.placeholder.com/90/ffffff/000000?text=üë§';
      if (editIndex === -1) {
        users.push({ name, email, avatar, favorite: false });
      } else {
        users[editIndex] = { ...users[editIndex], name, email, avatar };
        editIndex = -1;
      }
      userForm.reset();
      renderUsers();
    };
    if (avatarFile) reader.readAsDataURL(avatarFile);
    else {
      if (editIndex === -1)
        users.push({ name, email, avatar: 'https://via.placeholder.com/90/ffffff/000000?text=üë§', favorite: false });
      else {
        users[editIndex] = { ...users[editIndex], name, email };
        editIndex = -1;
      }
      userForm.reset();
      renderUsers();
    }
  });

  function renderUsers() {
    userGrid.innerHTML = '';
    const keyword = search.value.toLowerCase();
    users
      .filter((u) => u.name.toLowerCase().includes(keyword) || u.email.toLowerCase().includes(keyword))
      .forEach((user, index) => {
        const col = document.createElement('div');
        col.className = 'col-md-4 mb-4 animate__animated animate__fadeInUp';
        col.innerHTML = `
          <div class="user-card">
            <span class="favorite" onclick="toggleFavorite(${index})">${user.favorite ? '‚ù§Ô∏è' : 'ü§ç'}</span>
            <img src="${user.avatar}" class="avatar" alt="avatar">
            <h5>${user.name}</h5>
            <p>${user.email}</p>
            <div class="d-flex justify-content-center mt-2">
              <button class="btn btn-warning btn-sm btn-custom" onclick="editUser(${index})">‚úèÔ∏è Edit</button>
            </div>
          </div>
        `;
        userGrid.appendChild(col);
      });
  }

  function toggleFavorite(index) {
    users[index].favorite = !users[index].favorite;
    renderUsers();
  }

  function editUser(index) {
    document.getElementById('name').value = users[index].name;
    document.getElementById('email').value = users[index].email;
    editIndex = index;
    document.getElementById('formSection').classList.add('show');
  }

  search.addEventListener('input', renderUsers);
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
